server {
    listen 80;  # Port ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö (‡πÉ‡∏ä‡πâ 80 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö HTTP)
    server_name localhost;  # ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏Ñ‡∏∏‡∏ì‡∏Å‡πá‡πÑ‡∏î‡πâ

    # Root directory ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü static files (‡∏Å‡∏£‡∏ì‡∏µ frontend build)
    root /usr/share/nginx/html;
    index index.html;

    # ---------- 1. Static Files ‡πÄ‡∏ä‡πà‡∏ô index.html, js, css ----------
    location /gradkmutt/assets/ {
        try_files $uri =404;
    }

    location ~* \.(js|css|png|jpg|jpeg|svg|ico|woff|woff2|ttf)$ {
        try_files $uri =404;
    }

    # ---------- 2. Reverse Proxy ‡πÑ‡∏õ‡∏¢‡∏±‡∏á grad.kmutt.ac.th ----------
    location /gradkmutt/login {
        proxy_pass https://grad.kmutt.ac.th/gradkmutt/login;  # üß≠ ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
        proxy_set_header Host grad.kmutt.ac.th;  # ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö domain ‡∏à‡∏£‡∏¥‡∏á
        proxy_set_header X-Real-IP $remote_addr;  # ‡∏™‡πà‡∏á IP ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_ssl_server_name on;  # üîê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö HTTPS
    }

    # ---------- 3. Fallback ‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÑ‡∏õ index.html ----------
    location /gradkmutt/ {
        try_files $uri /index.html;
    }

    # ---------- 4. ‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏ô‡∏¥‡∏î MIME ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ----------
    types {
        text/css css;
        application/javascript js;
    }

    # ---------- 5. ‡πÄ‡∏û‡∏¥‡πà‡∏° Cache-Control ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Static Files (Optional) ----------
    location ~* \.(js|css|png|jpg|jpeg|svg|ico|woff|woff2|ttf)$ {
        expires 1y;
        access_log off;
        add_header Cache-Control "public";
    }
}
